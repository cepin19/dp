[2019-03-01 16:20:29] [marian] Marian v1.7.8 63e1cfe4 2019-02-11 21:04:00 -0800
[2019-03-01 16:20:29] [marian] Running on poseidon.lingea.cz as process 28424 with command line:
[2019-03-01 16:20:29] [marian] /home/large/data/models/marian/marian-doc/marian-dev/build/marian --model model/model.src1tgt0.doc.gate.diff_emb.npz --type transformer-context --train-sets corp/europarl.cs-en.docs.train.en.bpe.src_prev corp/europarl.cs-en.docs.train.en.bpe.src corp/europarl.cs-en.docs.train.cz.bpe --max-length 55 --dim-vocabs 30000 30000 --vocabs corp/vocab.encs.europarl.yml corp/vocab.encs.europarl.yml corp/vocab.encs.europarl.yml --mini-batch-fit -w 8900 --mini-batch 1000 --maxi-batch 1000 --early-stopping 10 --valid-freq 5000 --save-freq 5000 --disp-freq 500 --valid-metrics cross-entropy perplexity translation --valid-sets corp/europarl.cs-en.docs.dev.en.bpe.src_prev corp/europarl.cs-en.docs.dev.en.bpe.src corp/europarl.cs-en.docs.dev.cz.bpe --valid-script-path ./val.sh --valid-translation-output data/valid.bpe.en.output --quiet-translation --valid-mini-batch 16 --beam-size 6 --normalize 0.6 --log model/train_trans.doc.log --valid-log model/valid_trans.doc.log --enc-depth 6 --dec-depth 6 --transformer-heads 8 --transformer-postprocess-emb d --transformer-postprocess dan --transformer-dropout 0.1 --label-smoothing 0.1 --learn-rate 0.0003 --lr-warmup 16000 --lr-decay-inv-sqrt 16000 --lr-report --optimizer-params 0.9 0.98 1e-09 --clip-norm 5 --tied-embeddings-all --devices 0 1 --sync-sgd --seed 1111 --exponential-smoothing --no-restore-corpus --no-nccl
[2019-03-01 16:20:29] [config] after-batches: 0
[2019-03-01 16:20:29] [config] after-epochs: 0
[2019-03-01 16:20:29] [config] allow-unk: false
[2019-03-01 16:20:29] [config] beam-size: 6
[2019-03-01 16:20:29] [config] bert-class-symbol: "[CLS]"
[2019-03-01 16:20:29] [config] bert-mask-symbol: "[MASK]"
[2019-03-01 16:20:29] [config] bert-masking-fraction: 0.15
[2019-03-01 16:20:29] [config] bert-sep-symbol: "[SEP]"
[2019-03-01 16:20:29] [config] bert-train-type-embeddings: true
[2019-03-01 16:20:29] [config] bert-type-vocab-size: 2
[2019-03-01 16:20:29] [config] best-deep: false
[2019-03-01 16:20:29] [config] clip-gemm: 0
[2019-03-01 16:20:29] [config] clip-norm: 5
[2019-03-01 16:20:29] [config] cost-type: ce-mean
[2019-03-01 16:20:29] [config] cpu-threads: 0
[2019-03-01 16:20:29] [config] data-weighting: ""
[2019-03-01 16:20:29] [config] data-weighting-type: sentence
[2019-03-01 16:20:29] [config] dec-cell: gru
[2019-03-01 16:20:29] [config] dec-cell-base-depth: 2
[2019-03-01 16:20:29] [config] dec-cell-high-depth: 1
[2019-03-01 16:20:29] [config] dec-depth: 6
[2019-03-01 16:20:29] [config] devices:
[2019-03-01 16:20:29] [config]   - 0
[2019-03-01 16:20:29] [config]   - 1
[2019-03-01 16:20:29] [config] dim-emb: 512
[2019-03-01 16:20:29] [config] dim-rnn: 1024
[2019-03-01 16:20:29] [config] dim-vocabs:
[2019-03-01 16:20:29] [config]   - 30000
[2019-03-01 16:20:29] [config]   - 30000
[2019-03-01 16:20:29] [config] disp-first: 0
[2019-03-01 16:20:29] [config] disp-freq: 500
[2019-03-01 16:20:29] [config] disp-label-counts: false
[2019-03-01 16:20:29] [config] dropout-rnn: 0
[2019-03-01 16:20:29] [config] dropout-src: 0
[2019-03-01 16:20:29] [config] dropout-trg: 0
[2019-03-01 16:20:29] [config] dump-config: ""
[2019-03-01 16:20:29] [config] early-stopping: 10
[2019-03-01 16:20:29] [config] embedding-fix-src: false
[2019-03-01 16:20:29] [config] embedding-fix-trg: false
[2019-03-01 16:20:29] [config] embedding-normalization: false
[2019-03-01 16:20:29] [config] embedding-vectors:
[2019-03-01 16:20:29] [config]   []
[2019-03-01 16:20:29] [config] enc-cell: gru
[2019-03-01 16:20:29] [config] enc-cell-depth: 1
[2019-03-01 16:20:29] [config] enc-depth: 6
[2019-03-01 16:20:29] [config] enc-type: bidirectional
[2019-03-01 16:20:29] [config] exponential-smoothing: 0.0001
[2019-03-01 16:20:29] [config] grad-dropping-momentum: 0
[2019-03-01 16:20:29] [config] grad-dropping-rate: 0
[2019-03-01 16:20:29] [config] grad-dropping-warmup: 100
[2019-03-01 16:20:29] [config] guided-alignment: none
[2019-03-01 16:20:29] [config] guided-alignment-cost: mse
[2019-03-01 16:20:29] [config] guided-alignment-weight: 0.1
[2019-03-01 16:20:29] [config] ignore-model-config: false
[2019-03-01 16:20:29] [config] input-types:
[2019-03-01 16:20:29] [config]   []
[2019-03-01 16:20:29] [config] interpolate-env-vars: false
[2019-03-01 16:20:29] [config] keep-best: false
[2019-03-01 16:20:29] [config] label-smoothing: 0.1
[2019-03-01 16:20:29] [config] layer-normalization: false
[2019-03-01 16:20:29] [config] learn-rate: 0.0003
[2019-03-01 16:20:29] [config] log: model/train_trans.doc.log
[2019-03-01 16:20:29] [config] log-level: info
[2019-03-01 16:20:29] [config] log-time-zone: ""
[2019-03-01 16:20:29] [config] lr-decay: 0
[2019-03-01 16:20:29] [config] lr-decay-freq: 50000
[2019-03-01 16:20:29] [config] lr-decay-inv-sqrt:
[2019-03-01 16:20:29] [config]   - 16000
[2019-03-01 16:20:29] [config] lr-decay-repeat-warmup: false
[2019-03-01 16:20:29] [config] lr-decay-reset-optimizer: false
[2019-03-01 16:20:29] [config] lr-decay-start:
[2019-03-01 16:20:29] [config]   - 10
[2019-03-01 16:20:29] [config]   - 1
[2019-03-01 16:20:29] [config] lr-decay-strategy: epoch+stalled
[2019-03-01 16:20:29] [config] lr-report: true
[2019-03-01 16:20:29] [config] lr-warmup: 16000
[2019-03-01 16:20:29] [config] lr-warmup-at-reload: false
[2019-03-01 16:20:29] [config] lr-warmup-cycle: false
[2019-03-01 16:20:29] [config] lr-warmup-start-rate: 0
[2019-03-01 16:20:29] [config] max-length: 55
[2019-03-01 16:20:29] [config] max-length-crop: false
[2019-03-01 16:20:29] [config] max-length-factor: 3
[2019-03-01 16:20:29] [config] maxi-batch: 1000
[2019-03-01 16:20:29] [config] maxi-batch-sort: trg
[2019-03-01 16:20:29] [config] mini-batch: 1000
[2019-03-01 16:20:29] [config] mini-batch-fit: true
[2019-03-01 16:20:29] [config] mini-batch-fit-step: 10
[2019-03-01 16:20:29] [config] mini-batch-overstuff: 1
[2019-03-01 16:20:29] [config] mini-batch-track-lr: false
[2019-03-01 16:20:29] [config] mini-batch-understuff: 1
[2019-03-01 16:20:29] [config] mini-batch-warmup: 0
[2019-03-01 16:20:29] [config] mini-batch-words: 0
[2019-03-01 16:20:29] [config] mini-batch-words-ref: 0
[2019-03-01 16:20:29] [config] model: model/model.src1tgt0.doc.gate.diff_emb.npz
[2019-03-01 16:20:29] [config] multi-loss-type: sum
[2019-03-01 16:20:29] [config] multi-node: false
[2019-03-01 16:20:29] [config] multi-node-overlap: true
[2019-03-01 16:20:29] [config] n-best: false
[2019-03-01 16:20:29] [config] no-nccl: true
[2019-03-01 16:20:29] [config] no-reload: false
[2019-03-01 16:20:29] [config] no-restore-corpus: true
[2019-03-01 16:20:29] [config] no-shuffle: false
[2019-03-01 16:20:29] [config] normalize: 0.6
[2019-03-01 16:20:29] [config] num-devices: 0
[2019-03-01 16:20:29] [config] optimizer: adam
[2019-03-01 16:20:29] [config] optimizer-delay: 1
[2019-03-01 16:20:29] [config] optimizer-params:
[2019-03-01 16:20:29] [config]   - 0.9
[2019-03-01 16:20:29] [config]   - 0.98
[2019-03-01 16:20:29] [config]   - 1e-09
[2019-03-01 16:20:29] [config] overwrite: false
[2019-03-01 16:20:29] [config] pretrained-model: ""
[2019-03-01 16:20:29] [config] quiet: false
[2019-03-01 16:20:29] [config] quiet-translation: true
[2019-03-01 16:20:29] [config] relative-paths: false
[2019-03-01 16:20:29] [config] right-left: false
[2019-03-01 16:20:29] [config] save-freq: 5000
[2019-03-01 16:20:29] [config] seed: 1111
[2019-03-01 16:20:29] [config] shuffle-in-ram: false
[2019-03-01 16:20:29] [config] skip: false
[2019-03-01 16:20:29] [config] sqlite: ""
[2019-03-01 16:20:29] [config] sqlite-drop: false
[2019-03-01 16:20:29] [config] sync-sgd: true
[2019-03-01 16:20:29] [config] tempdir: /tmp
[2019-03-01 16:20:29] [config] tied-embeddings: false
[2019-03-01 16:20:29] [config] tied-embeddings-all: true
[2019-03-01 16:20:29] [config] tied-embeddings-src: false
[2019-03-01 16:20:29] [config] train-sets:
[2019-03-01 16:20:29] [config]   - corp/europarl.cs-en.docs.train.en.bpe.src_prev
[2019-03-01 16:20:29] [config]   - corp/europarl.cs-en.docs.train.en.bpe.src
[2019-03-01 16:20:29] [config]   - corp/europarl.cs-en.docs.train.cz.bpe
[2019-03-01 16:20:29] [config] transformer-aan-activation: swish
[2019-03-01 16:20:29] [config] transformer-aan-depth: 2
[2019-03-01 16:20:29] [config] transformer-aan-nogate: false
[2019-03-01 16:20:29] [config] transformer-decoder-autoreg: self-attention
[2019-03-01 16:20:29] [config] transformer-dim-aan: 2048
[2019-03-01 16:20:29] [config] transformer-dim-ffn: 2048
[2019-03-01 16:20:29] [config] transformer-dropout: 0.1
[2019-03-01 16:20:29] [config] transformer-dropout-attention: 0
[2019-03-01 16:20:29] [config] transformer-dropout-ffn: 0
[2019-03-01 16:20:29] [config] transformer-ffn-activation: swish
[2019-03-01 16:20:29] [config] transformer-ffn-depth: 2
[2019-03-01 16:20:29] [config] transformer-guided-alignment-layer: last
[2019-03-01 16:20:29] [config] transformer-heads: 8
[2019-03-01 16:20:29] [config] transformer-no-projection: false
[2019-03-01 16:20:29] [config] transformer-postprocess: dan
[2019-03-01 16:20:29] [config] transformer-postprocess-emb: d
[2019-03-01 16:20:29] [config] transformer-preprocess: ""
[2019-03-01 16:20:29] [config] transformer-tied-layers:
[2019-03-01 16:20:29] [config]   []
[2019-03-01 16:20:29] [config] transformer-train-position-embeddings: false
[2019-03-01 16:20:29] [config] type: transformer-context
[2019-03-01 16:20:29] [config] ulr: false
[2019-03-01 16:20:29] [config] ulr-dim-emb: 0
[2019-03-01 16:20:29] [config] ulr-dropout: 0
[2019-03-01 16:20:29] [config] ulr-keys-vectors: ""
[2019-03-01 16:20:29] [config] ulr-query-vectors: ""
[2019-03-01 16:20:29] [config] ulr-softmax-temperature: 1
[2019-03-01 16:20:29] [config] ulr-trainable-transformation: false
[2019-03-01 16:20:29] [config] valid-freq: 5000
[2019-03-01 16:20:29] [config] valid-log: model/valid_trans.doc.log
[2019-03-01 16:20:29] [config] valid-max-length: 1000
[2019-03-01 16:20:29] [config] valid-metrics:
[2019-03-01 16:20:29] [config]   - cross-entropy
[2019-03-01 16:20:29] [config]   - perplexity
[2019-03-01 16:20:29] [config]   - translation
[2019-03-01 16:20:29] [config] valid-mini-batch: 16
[2019-03-01 16:20:29] [config] valid-script-path: ./val.sh
[2019-03-01 16:20:29] [config] valid-sets:
[2019-03-01 16:20:29] [config]   - corp/europarl.cs-en.docs.dev.en.bpe.src_prev
[2019-03-01 16:20:29] [config]   - corp/europarl.cs-en.docs.dev.en.bpe.src
[2019-03-01 16:20:29] [config]   - corp/europarl.cs-en.docs.dev.cz.bpe
[2019-03-01 16:20:29] [config] valid-translation-output: data/valid.bpe.en.output
[2019-03-01 16:20:29] [config] vocabs:
[2019-03-01 16:20:29] [config]   - corp/vocab.encs.europarl.yml
[2019-03-01 16:20:29] [config]   - corp/vocab.encs.europarl.yml
[2019-03-01 16:20:29] [config]   - corp/vocab.encs.europarl.yml
[2019-03-01 16:20:29] [config] word-penalty: 0
[2019-03-01 16:20:29] [config] workspace: 8900
[2019-03-01 16:20:29] [config] Model is being created with Marian v1.7.8 63e1cfe4 2019-02-11 21:04:00 -0800
[2019-03-01 16:20:29] Using synchronous training
[2019-03-01 16:20:29] [data] Loading vocabulary from JSON/Yaml file corp/vocab.encs.europarl.yml
[2019-03-01 16:20:29] [data] Setting vocabulary size for input 0 to 30000
[2019-03-01 16:20:29] [data] Loading vocabulary from JSON/Yaml file corp/vocab.encs.europarl.yml
[2019-03-01 16:20:30] [data] Setting vocabulary size for input 1 to 30000
[2019-03-01 16:20:30] [data] Loading vocabulary from JSON/Yaml file corp/vocab.encs.europarl.yml
[2019-03-01 16:20:30] [data] Setting vocabulary size for input 2 to 30000
[2019-03-01 16:20:30] Compiled without MPI support. Falling back to FakeMPIWrapper
[2019-03-01 16:20:30] [batching] Collecting statistics for batch fitting with step size 10
[2019-03-01 16:20:31] [memory] Extending reserved space to 8960 MB (device gpu0)
[2019-03-01 16:20:32] [memory] Extending reserved space to 8960 MB (device gpu1)
[2019-03-01 16:20:32] [comm] NCCL communicator overridden
[2019-03-01 16:20:32] [training] Using 2 GPUs
[2019-03-01 16:20:32] [memory] Reserving 371 MB, device gpu0
[2019-03-01 16:20:32] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2019-03-01 16:20:34] [memory] Reserving 371 MB, device gpu0
[2019-03-01 16:20:44] [batching] Done. Typical MB size is 9203 target words
[2019-03-01 16:20:45] [memory] Extending reserved space to 8960 MB (device gpu0)
[2019-03-01 16:20:45] [memory] Extending reserved space to 8960 MB (device gpu1)
[2019-03-01 16:20:45] [comm] NCCL communicator overridden
[2019-03-01 16:20:45] [training] Using 2 GPUs
[2019-03-01 16:20:45] Training started
[2019-03-01 16:20:45] [data] Shuffling data
[2019-03-01 16:20:47] [data] Done reading 620637 sentences
[2019-03-01 16:20:51] [data] Done shuffling 620637 sentences to temp files
[2019-03-01 16:21:42] [training] Batches are processed as 1 process(es) x 2 devices/process
[2019-03-01 16:21:42] [memory] Reserving 371 MB, device gpu1
[2019-03-01 16:21:42] [memory] Reserving 371 MB, device gpu0
[2019-03-01 16:21:42] [memory] Reserving 371 MB, device gpu1
[2019-03-01 16:21:42] [memory] Reserving 371 MB, device gpu0
[2019-03-01 16:21:43] [memory] Reserving 185 MB, device gpu0
[2019-03-01 16:21:43] [memory] Reserving 185 MB, device gpu1
[2019-03-01 16:21:43] [memory] Reserving 185 MB, device gpu0
[2019-03-01 16:21:43] [memory] Reserving 185 MB, device gpu1
[2019-03-01 16:21:43] [memory] Reserving 371 MB, device gpu1
[2019-03-01 16:21:43] [memory] Reserving 371 MB, device gpu0
[2019-03-01 16:25:32] Ep. 1 : Up. 500 : Sen. 98,087 : Cost 252.47201538 : Time 302.08s : 8625.72 words/s : L.r. 9.3750e-06
[2019-03-01 16:29:20] Ep. 1 : Up. 1000 : Sen. 195,070 : Cost 215.22767639 : Time 227.90s : 11123.07 words/s : L.r. 1.8750e-05
[2019-03-01 16:33:10] Ep. 1 : Up. 1500 : Sen. 290,735 : Cost 218.85130310 : Time 230.16s : 11188.62 words/s : L.r. 2.8125e-05
[2019-03-01 16:37:02] Ep. 1 : Up. 2000 : Sen. 388,158 : Cost 216.85215759 : Time 232.21s : 11269.33 words/s : L.r. 3.7500e-05
[2019-03-01 16:40:52] Ep. 1 : Up. 2500 : Sen. 487,096 : Cost 208.92645264 : Time 230.01s : 11138.74 words/s : L.r. 4.6875e-05
[2019-03-01 16:41:59] Seen 515211 samples
[2019-03-01 16:41:59] Starting epoch 2
[2019-03-01 16:41:59] [data] Shuffling data
[2019-03-01 16:41:59] [data] Done reading 620637 sentences
[2019-03-01 16:42:03] [data] Done shuffling 620637 sentences to temp files
[2019-03-01 16:45:28] Ep. 2 : Up. 3000 : Sen. 69,386 : Cost 214.08065796 : Time 275.25s : 9371.75 words/s : L.r. 5.6250e-05
[2019-03-01 16:49:18] Ep. 2 : Up. 3500 : Sen. 166,009 : Cost 217.51202393 : Time 230.32s : 11194.92 words/s : L.r. 6.5625e-05
[2019-03-01 16:53:07] Ep. 2 : Up. 4000 : Sen. 264,279 : Cost 211.22004700 : Time 228.83s : 11054.31 words/s : L.r. 7.5000e-05
[2019-03-01 16:57:01] Ep. 2 : Up. 4500 : Sen. 360,826 : Cost 229.41902161 : Time 234.28s : 11409.69 words/s : L.r. 8.4375e-05
[2019-03-01 17:00:52] Ep. 2 : Up. 5000 : Sen. 459,144 : Cost 218.51341248 : Time 230.47s : 11140.96 words/s : L.r. 9.3750e-05
[2019-03-01 17:00:52] Saving model weights and runtime parameters to model/model.src1tgt0.doc.gate.diff_emb.npz.orig.npz
[2019-03-01 17:00:58] Saving model weights and runtime parameters to model/model.src1tgt0.doc.gate.diff_emb.iter5000.npz
[2019-03-01 17:01:05] Saving model weights and runtime parameters to model/model.src1tgt0.doc.gate.diff_emb.npz
[2019-03-01 17:01:12] Saving Adam parameters to model/model.src1tgt0.doc.gate.diff_emb.npz.optimizer.npz
[2019-03-01 17:01:34] [valid] Ep. 2 : Up. 5000 : cross-entropy : 238.694 : new best
[2019-03-01 17:01:42] [valid] Ep. 2 : Up. 5000 : perplexity : 2232.21 : new best
Detokenizer Version $Revision: 4134 $
Language: en
[2019-03-01 17:13:16] [valid] Ep. 2 : Up. 5000 : translation : 0 : new best
[2019-03-01 17:15:27] Seen 515211 samples
[2019-03-01 17:15:27] Starting epoch 3
[2019-03-01 17:15:27] [data] Shuffling data
[2019-03-01 17:15:28] [data] Done reading 620637 sentences
[2019-03-01 17:15:32] [data] Done shuffling 620637 sentences to temp files
[2019-03-01 17:17:51] Ep. 3 : Up. 5500 : Sen. 41,375 : Cost 223.32316589 : Time 1019.58s : 2527.21 words/s : L.r. 1.0313e-04
[2019-03-01 17:21:43] Ep. 3 : Up. 6000 : Sen. 141,453 : Cost 224.46441650 : Time 231.92s : 11359.18 words/s : L.r. 1.1250e-04
[2019-03-01 17:25:34] Ep. 3 : Up. 6500 : Sen. 239,247 : Cost 227.08139038 : Time 230.77s : 11192.52 words/s : L.r. 1.2188e-04
[2019-03-01 17:29:23] Ep. 3 : Up. 7000 : Sen. 336,631 : Cost 226.64834595 : Time 229.22s : 11112.99 words/s : L.r. 1.3125e-04
[2019-03-01 17:33:12] Ep. 3 : Up. 7500 : Sen. 433,159 : Cost 229.83422852 : Time 228.93s : 11078.74 words/s : L.r. 1.4063e-04
[2019-03-01 17:36:30] Seen 515211 samples
[2019-03-01 17:36:30] Starting epoch 4
[2019-03-01 17:36:30] [data] Shuffling data
[2019-03-01 17:36:31] [data] Done reading 620637 sentences
[2019-03-01 17:36:34] [data] Done shuffling 620637 sentences to temp files
[2019-03-01 17:37:48] Ep. 4 : Up. 8000 : Sen. 13,694 : Cost 237.85331726 : Time 275.52s : 9395.12 words/s : L.r. 1.5000e-04
[2019-03-01 17:41:40] Ep. 4 : Up. 8500 : Sen. 110,758 : Cost 240.63774109 : Time 231.99s : 11396.44 words/s : L.r. 1.5938e-04
[2019-03-01 17:45:29] Ep. 4 : Up. 9000 : Sen. 207,744 : Cost 235.57344055 : Time 229.14s : 11207.18 words/s : L.r. 1.6875e-04
[2019-03-01 17:49:18] Ep. 4 : Up. 9500 : Sen. 307,128 : Cost 232.25595093 : Time 229.47s : 11199.73 words/s : L.r. 1.7813e-04
[2019-03-01 17:53:05] Ep. 4 : Up. 10000 : Sen. 403,276 : Cost 243.18051147 : Time 227.19s : 11090.11 words/s : L.r. 1.8750e-04
[2019-03-01 17:53:05] Saving model weights and runtime parameters to model/model.src1tgt0.doc.gate.diff_emb.npz.orig.npz
[2019-03-01 17:53:12] Saving model weights and runtime parameters to model/model.src1tgt0.doc.gate.diff_emb.iter10000.npz
[2019-03-01 17:53:19] Saving model weights and runtime parameters to model/model.src1tgt0.doc.gate.diff_emb.npz
[2019-03-01 17:53:27] Saving Adam parameters to model/model.src1tgt0.doc.gate.diff_emb.npz.optimizer.npz
[2019-03-01 17:53:48] [valid] Ep. 4 : Up. 10000 : cross-entropy : 273.195 : stalled 1 times (last best: 238.694)
[2019-03-01 17:53:56] [valid] Ep. 4 : Up. 10000 : perplexity : 6803.78 : stalled 1 times (last best: 2232.21)
Detokenizer Version $Revision: 4134 $
Language: en
[2019-03-01 18:05:13] [valid] Ep. 4 : Up. 10000 : translation : 0 : stalled 1 times (last best: 0)
[2019-03-01 18:09:03] Ep. 4 : Up. 10500 : Sen. 501,926 : Cost 249.92919922 : Time 957.84s : 2717.04 words/s : L.r. 1.9688e-04
[2019-03-01 18:09:37] Seen 515211 samples
[2019-03-01 18:09:37] Starting epoch 5
[2019-03-01 18:09:37] [data] Shuffling data
[2019-03-01 18:09:37] [data] Done reading 620637 sentences
[2019-03-01 18:09:41] [data] Done shuffling 620637 sentences to temp files
[2019-03-01 18:13:39] Ep. 5 : Up. 11000 : Sen. 85,899 : Cost 251.27867126 : Time 276.02s : 9427.31 words/s : L.r. 2.0625e-04
[2019-03-01 18:17:27] Ep. 5 : Up. 11500 : Sen. 184,878 : Cost 270.83935547 : Time 227.62s : 11197.54 words/s : L.r. 2.1563e-04
[2019-03-01 18:21:16] Ep. 5 : Up. 12000 : Sen. 281,393 : Cost 310.17309570 : Time 229.44s : 11281.37 words/s : L.r. 2.2500e-04
[2019-03-01 18:25:07] Ep. 5 : Up. 12500 : Sen. 377,565 : Cost 306.60208130 : Time 230.61s : 11345.76 words/s : L.r. 2.3438e-04
[2019-03-01 18:28:54] Ep. 5 : Up. 13000 : Sen. 473,206 : Cost 331.94549561 : Time 227.20s : 11118.95 words/s : L.r. 2.4375e-04
[2019-03-01 18:30:34] Seen 515211 samples
[2019-03-01 18:30:34] Starting epoch 6
[2019-03-01 18:30:34] [data] Shuffling data
[2019-03-01 18:30:35] [data] Done reading 620637 sentences
[2019-03-01 18:30:39] [data] Done shuffling 620637 sentences to temp files
[2019-03-01 18:33:28] Ep. 6 : Up. 13500 : Sen. 54,080 : Cost 313.00988770 : Time 274.27s : 9349.34 words/s : L.r. 2.5313e-04
[2019-03-01 18:37:19] Ep. 6 : Up. 14000 : Sen. 148,890 : Cost 375.89611816 : Time 231.03s : 11399.77 words/s : L.r. 2.6250e-04
[2019-03-01 18:41:10] Ep. 6 : Up. 14500 : Sen. 248,611 : Cost 406.05310059 : Time 230.96s : 11412.57 words/s : L.r. 2.7188e-04
[2019-03-01 18:45:01] Ep. 6 : Up. 15000 : Sen. 350,672 : Cost 483.19427490 : Time 231.05s : 11302.70 words/s : L.r. 2.8125e-04
[2019-03-01 18:45:01] Saving model weights and runtime parameters to model/model.src1tgt0.doc.gate.diff_emb.npz.orig.npz
[2019-03-01 18:45:08] Saving model weights and runtime parameters to model/model.src1tgt0.doc.gate.diff_emb.iter15000.npz
[2019-03-01 18:45:15] Saving model weights and runtime parameters to model/model.src1tgt0.doc.gate.diff_emb.npz
[2019-03-01 18:45:22] Saving Adam parameters to model/model.src1tgt0.doc.gate.diff_emb.npz.optimizer.npz
[2019-03-01 18:45:43] [valid] Ep. 6 : Up. 15000 : cross-entropy : 310.701 : stalled 2 times (last best: 238.694)
[2019-03-01 18:45:51] [valid] Ep. 6 : Up. 15000 : perplexity : 22853 : stalled 2 times (last best: 2232.21)
Detokenizer Version $Revision: 4134 $
Language: en
[2019-03-01 19:14:42] [valid] Ep. 6 : Up. 15000 : translation : 0 : stalled 2 times (last best: 0)
[2019-03-01 19:18:29] Ep. 6 : Up. 15500 : Sen. 445,652 : Cost 500.83871460 : Time 2007.55s : 1261.86 words/s : L.r. 2.9063e-04
[2019-03-01 19:21:12] Seen 515211 samples
[2019-03-01 19:21:12] Starting epoch 7
[2019-03-01 19:21:12] [data] Shuffling data
[2019-03-01 19:21:12] [data] Done reading 620637 sentences
[2019-03-01 19:21:16] [data] Done shuffling 620637 sentences to temp files
[2019-03-01 19:23:03] Ep. 7 : Up. 16000 : Sen. 26,339 : Cost 498.01919556 : Time 273.75s : 9276.76 words/s : L.r. 3.0000e-04
[2019-03-01 19:26:50] Ep. 7 : Up. 16500 : Sen. 122,180 : Cost 553.48553467 : Time 226.86s : 11157.27 words/s : L.r. 2.9542e-04
[2019-03-01 19:30:38] Ep. 7 : Up. 17000 : Sen. 222,472 : Cost 505.53994751 : Time 228.78s : 11215.15 words/s : L.r. 2.9104e-04
[2019-03-01 19:34:27] Ep. 7 : Up. 17500 : Sen. 320,295 : Cost 562.87927246 : Time 228.50s : 11183.48 words/s : L.r. 2.8685e-04
[2019-03-01 19:38:18] Ep. 7 : Up. 18000 : Sen. 419,000 : Cost 821.97003174 : Time 231.48s : 11412.20 words/s : L.r. 2.8284e-04
[2019-03-01 19:42:09] Ep. 7 : Up. 18500 : Sen. 515,073 : Cost 706.99786377 : Time 230.60s : 11367.70 words/s : L.r. 2.7899e-04
[2019-03-01 19:42:09] Seen 515211 samples
[2019-03-01 19:42:09] Starting epoch 8
[2019-03-01 19:42:09] [data] Shuffling data
[2019-03-01 19:42:10] [data] Done reading 620637 sentences
[2019-03-01 19:42:14] [data] Done shuffling 620637 sentences to temp files
[2019-03-01 19:46:45] Ep. 8 : Up. 19000 : Sen. 99,345 : Cost 747.39898682 : Time 276.50s : 9436.98 words/s : L.r. 2.7530e-04
[2019-03-01 19:50:32] Ep. 8 : Up. 19500 : Sen. 191,783 : Cost 633.80651855 : Time 226.70s : 11121.58 words/s : L.r. 2.7175e-04
[2019-03-01 19:54:22] Ep. 8 : Up. 20000 : Sen. 289,411 : Cost 375.15301514 : Time 230.09s : 11321.53 words/s : L.r. 2.6833e-04
[2019-03-01 19:54:22] Saving model weights and runtime parameters to model/model.src1tgt0.doc.gate.diff_emb.npz.orig.npz
[2019-03-01 19:54:29] Saving model weights and runtime parameters to model/model.src1tgt0.doc.gate.diff_emb.iter20000.npz
[2019-03-01 19:54:35] Saving model weights and runtime parameters to model/model.src1tgt0.doc.gate.diff_emb.npz
[2019-03-01 19:54:42] Saving Adam parameters to model/model.src1tgt0.doc.gate.diff_emb.npz.optimizer.npz
[2019-03-01 19:55:03] [valid] Ep. 8 : Up. 20000 : cross-entropy : 519.619 : stalled 3 times (last best: 238.694)
[2019-03-01 19:55:11] [valid] Ep. 8 : Up. 20000 : perplexity : 1.94957e+07 : stalled 3 times (last best: 2232.21)
Detokenizer Version $Revision: 4134 $
Language: en
[2019-03-01 20:23:47] [valid] Ep. 8 : Up. 20000 : translation : 0 : stalled 3 times (last best: 0)
[2019-03-01 20:27:34] Ep. 8 : Up. 20500 : Sen. 385,468 : Cost 403.25930786 : Time 1992.19s : 1263.95 words/s : L.r. 2.6504e-04
[2019-03-01 20:31:27] Ep. 8 : Up. 21000 : Sen. 485,734 : Cost 343.04956055 : Time 232.37s : 11424.99 words/s : L.r. 2.6186e-04
[2019-03-01 20:32:33] Seen 515211 samples
[2019-03-01 20:32:33] Starting epoch 9
[2019-03-01 20:32:33] [data] Shuffling data
[2019-03-01 20:32:33] [data] Done reading 620637 sentences
[2019-03-01 20:32:37] [data] Done shuffling 620637 sentences to temp files
[2019-03-01 20:36:01] Ep. 9 : Up. 21500 : Sen. 69,729 : Cost 323.93887329 : Time 273.86s : 9425.20 words/s : L.r. 2.5880e-04
[2019-03-01 20:39:50] Ep. 9 : Up. 22000 : Sen. 168,464 : Cost 325.24310303 : Time 229.55s : 11287.26 words/s : L.r. 2.5584e-04
[2019-03-01 20:43:38] Ep. 9 : Up. 22500 : Sen. 262,688 : Cost 333.57046509 : Time 227.92s : 11163.47 words/s : L.r. 2.5298e-04
[2019-03-01 20:47:29] Ep. 9 : Up. 23000 : Sen. 362,065 : Cost 319.69732666 : Time 230.61s : 11298.15 words/s : L.r. 2.5022e-04
[2019-03-01 20:51:19] Ep. 9 : Up. 23500 : Sen. 461,406 : Cost 359.30429077 : Time 230.30s : 11299.79 words/s : L.r. 2.4754e-04
[2019-03-01 20:53:30] Seen 515211 samples
[2019-03-01 20:53:30] Starting epoch 10
[2019-03-01 20:53:30] [data] Shuffling data
[2019-03-01 20:53:30] [data] Done reading 620637 sentences
[2019-03-01 20:53:34] [data] Done shuffling 620637 sentences to temp files
[2019-03-01 20:55:52] Ep. 10 : Up. 24000 : Sen. 41,651 : Cost 401.42095947 : Time 272.84s : 9408.99 words/s : L.r. 2.4495e-04
[2019-03-01 20:59:41] Ep. 10 : Up. 24500 : Sen. 138,920 : Cost 410.02273560 : Time 229.59s : 11333.58 words/s : L.r. 2.4244e-04
[2019-03-01 21:03:30] Ep. 10 : Up. 25000 : Sen. 236,613 : Cost 437.01251221 : Time 228.60s : 11182.31 words/s : L.r. 2.4000e-04
[2019-03-01 21:03:30] Saving model weights and runtime parameters to model/model.src1tgt0.doc.gate.diff_emb.npz.orig.npz
[2019-03-01 21:03:37] Saving model weights and runtime parameters to model/model.src1tgt0.doc.gate.diff_emb.iter25000.npz
[2019-03-01 21:03:43] Saving model weights and runtime parameters to model/model.src1tgt0.doc.gate.diff_emb.npz
[2019-03-01 21:03:50] Saving Adam parameters to model/model.src1tgt0.doc.gate.diff_emb.npz.optimizer.npz
[2019-03-01 21:04:11] [valid] Ep. 10 : Up. 25000 : cross-entropy : 754.657 : stalled 4 times (last best: 238.694)
[2019-03-01 21:04:19] [valid] Ep. 10 : Up. 25000 : perplexity : 3.86695e+10 : stalled 4 times (last best: 2232.21)
Detokenizer Version $Revision: 4134 $
Language: en
[2019-03-01 21:33:24] [valid] Ep. 10 : Up. 25000 : translation : 0 : stalled 4 times (last best: 0)
[2019-03-01 21:37:14] Ep. 10 : Up. 25500 : Sen. 336,389 : Cost 448.19186401 : Time 2024.34s : 1278.73 words/s : L.r. 2.3764e-04
[2019-03-01 21:41:03] Ep. 10 : Up. 26000 : Sen. 431,299 : Cost 480.71548462 : Time 228.70s : 11179.04 words/s : L.r. 2.3534e-04
[2019-03-01 21:44:21] Seen 515211 samples
[2019-03-01 21:44:21] Starting epoch 11
[2019-03-01 21:44:21] [data] Shuffling data
[2019-03-01 21:44:22] [data] Done reading 620637 sentences
[2019-03-01 21:44:25] [data] Done shuffling 620637 sentences to temp files
[2019-03-01 21:45:39] Ep. 11 : Up. 26500 : Sen. 13,908 : Cost 501.40359497 : Time 276.28s : 9473.98 words/s : L.r. 2.3311e-04
[2019-03-01 21:49:29] Ep. 11 : Up. 27000 : Sen. 111,721 : Cost 537.03009033 : Time 229.52s : 11362.02 words/s : L.r. 2.3094e-04
[2019-03-01 21:53:19] Ep. 11 : Up. 27500 : Sen. 207,391 : Cost 724.86511230 : Time 230.46s : 11284.44 words/s : L.r. 2.2883e-04
[2019-03-01 21:57:09] Ep. 11 : Up. 28000 : Sen. 303,677 : Cost 582.90869141 : Time 229.30s : 11223.38 words/s : L.r. 2.2678e-04
[2019-03-01 22:00:58] Ep. 11 : Up. 28500 : Sen. 401,341 : Cost 513.56903076 : Time 228.86s : 11197.84 words/s : L.r. 2.2478e-04
[2019-03-01 22:04:46] Ep. 11 : Up. 29000 : Sen. 500,339 : Cost 463.57751465 : Time 228.40s : 11158.27 words/s : L.r. 2.2283e-04
[2019-03-01 22:05:20] Seen 515211 samples
[2019-03-01 22:05:20] Starting epoch 12
[2019-03-01 22:05:20] [data] Shuffling data
[2019-03-01 22:05:20] [data] Done reading 620637 sentences
[2019-03-01 22:05:24] [data] Done shuffling 620637 sentences to temp files
[2019-03-01 22:09:20] Ep. 12 : Up. 29500 : Sen. 82,209 : Cost 461.25341797 : Time 274.34s : 9355.14 words/s : L.r. 2.2094e-04
[2019-03-01 22:13:12] Ep. 12 : Up. 30000 : Sen. 178,858 : Cost 547.58642578 : Time 231.83s : 11421.60 words/s : L.r. 2.1909e-04
[2019-03-01 22:13:12] Saving model weights and runtime parameters to model/model.src1tgt0.doc.gate.diff_emb.npz.orig.npz
[2019-03-01 22:13:19] Saving model weights and runtime parameters to model/model.src1tgt0.doc.gate.diff_emb.iter30000.npz
[2019-03-01 22:13:25] Saving model weights and runtime parameters to model/model.src1tgt0.doc.gate.diff_emb.npz
[2019-03-01 22:13:32] Saving Adam parameters to model/model.src1tgt0.doc.gate.diff_emb.npz.optimizer.npz
[2019-03-01 22:13:53] [valid] Ep. 12 : Up. 30000 : cross-entropy : 3591.93 : stalled 5 times (last best: 238.694)
[2019-03-01 22:14:01] [valid] Ep. 12 : Up. 30000 : perplexity : inf : stalled 5 times (last best: 2232.21)
Detokenizer Version $Revision: 4134 $
Language: en
[2019-03-01 22:42:23] [valid] Ep. 12 : Up. 30000 : translation : 0 : stalled 5 times (last best: 0)
[2019-03-01 22:46:14] Ep. 12 : Up. 30500 : Sen. 278,998 : Cost 661.88525391 : Time 1982.31s : 1315.26 words/s : L.r. 2.1729e-04
[2019-03-01 22:50:04] Ep. 12 : Up. 31000 : Sen. 376,277 : Cost 645.19543457 : Time 229.47s : 11249.20 words/s : L.r. 2.1553e-04
[2019-03-01 22:53:53] Ep. 12 : Up. 31500 : Sen. 471,524 : Cost 629.29815674 : Time 228.79s : 11177.13 words/s : L.r. 2.1381e-04
[2019-03-01 22:55:30] Seen 515211 samples
[2019-03-01 22:55:30] Starting epoch 13
[2019-03-01 22:55:30] [data] Shuffling data
[2019-03-01 22:55:30] [data] Done reading 620637 sentences
[2019-03-01 22:55:34] [data] Done shuffling 620637 sentences to temp files
train_dual_doc.diff_emb.sh: line 27: 28424 Terminated              $marian_home/marian --model model/model.src1tgt0.doc.gate.diff_emb.npz --type transformer-context --train-sets corp/europarl.cs-en.docs.train.en.bpe.src_prev corp/europarl.cs-en.docs.train.en.bpe.src corp/europarl.cs-en.docs.train.cz.bpe --max-length 55 --dim-vocabs 30000 30000 --vocabs corp/vocab.encs.europarl.yml corp/vocab.encs.europarl.yml corp/vocab.encs.europarl.yml --mini-batch-fit -w 8900 --mini-batch 1000 --maxi-batch 1000 --early-stopping 10 --valid-freq 5000 --save-freq 5000 --disp-freq 500 --valid-metrics cross-entropy perplexity translation --valid-sets corp/europarl.cs-en.docs.dev.en.bpe.src_prev corp/europarl.cs-en.docs.dev.en.bpe.src corp/europarl.cs-en.docs.dev.cz.bpe --valid-script-path ./val.sh --valid-translation-output data/valid.bpe.en.output --quiet-translation --valid-mini-batch 16 --beam-size 6 --normalize 0.6 --log model/train_trans.doc.log --valid-log model/valid_trans.doc.log --enc-depth 6 --dec-depth 6 --transformer-heads 8 --transformer-postprocess-emb d --transformer-postprocess dan --transformer-dropout 0.1 --label-smoothing 0.1 --learn-rate 0.0003 --lr-warmup 16000 --lr-decay-inv-sqrt 16000 --lr-report --optimizer-params 0.9 0.98 1e-09 --clip-norm 5 --tied-embeddings-all --devices 0 1 --sync-sgd --seed 1111 --exponential-smoothing --no-restore-corpus --no-nccl
